<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BMSCE Event Hub - Full Prototype</title>
    <!-- Load Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            padding-top: 100px;
        }
        /* Custom dropdown arrow for aesthetics */
        .dropdown-toggle::after {
            content: 'â–¼';
            margin-left: 0.25rem;
            font-size: 0.6rem;
            line-height: 1;
        }
        /* Style for the dropdown menu when hidden */
        .dropdown-menu-hidden {
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
        }
        /* Style for the dropdown menu when visible */
        .dropdown-menu-visible {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
    </style>
</head>
<body onclick="closeAllDropdowns(event)">

    <!-- PRIMARY HEADER & NAVIGATION -->
    <header class="fixed top-0 left-0 w-full bg-white shadow-lg z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Top Bar: Logo and Search -->
            <div class="flex items-center justify-between h-16 border-b border-gray-100">
                <a href="#" class="text-2xl font-extrabold text-blue-600 hover:text-blue-800 transition duration-150 ease-in-out tracking-tight">
                    BMSCE Event Hub
                </a>

                <!-- Search Bar -->
                <div class="relative max-w-sm w-full md:w-1/3">
                    <input 
                        id="eventSearch"
                        type="text" 
                        placeholder="Search events, dates, speakers..." 
                        class="w-full py-2 pl-10 pr-4 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                        onkeyup="applyFilters()"
                    >
                    <!-- Search Icon -->
                    <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                </div>
            </div>

            <!-- Main Navigation Links & Filters -->
            <nav class="flex flex-wrap items-center justify-center sm:justify-start space-x-0 sm:space-x-4 py-2 text-sm font-medium">
                <!-- Static Link -->
                <a href="#" onclick="switchView('posterboard')" class="text-gray-600 hover:bg-blue-50 hover:text-blue-600 px-3 py-2 rounded-lg transition duration-150 ease-in-out">Home</a>
                
                <!-- Timeline Subpage Link (View Switcher) -->
                <a href="#" onclick="switchView('timeline')" class="text-gray-600 hover:bg-blue-50 hover:text-blue-600 px-3 py-2 rounded-lg transition duration-150 ease-in-out font-semibold text-blue-600">Timeline View</a>
                
                <!-- Dropdown: Departments (Click-to-Toggle) -->
                <div class="relative inline-block text-left" id="dept-group">
                    <button id="dept-toggle" onclick="toggleDropdown(this)" class="dropdown-toggle text-gray-600 hover:bg-blue-50 hover:text-blue-600 px-3 py-2 rounded-lg transition duration-150 ease-in-out focus:outline-none">Departments</button>
                    <div id="departmentDropdown" class="absolute left-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-xl transition duration-200 z-20 origin-top dropdown-menu-hidden">
                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-filter-type="department" data-filter-value="All" onclick="selectFilter(this)">All Departments</a>
                        <!-- Department links generated by JS -->
                    </div>
                </div>

                <!-- Dropdown: Tags (Click-to-Toggle) -->
                <div class="relative inline-block text-left" id="tag-group">
                    <button id="tag-toggle" onclick="toggleDropdown(this)" class="dropdown-toggle text-gray-600 hover:bg-blue-50 hover:text-blue-600 px-3 py-2 rounded-lg transition duration-150 ease-in-out focus:outline-none">Tags</button>
                    <div id="tagDropdown" class="absolute left-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-xl transition duration-200 z-20 origin-top dropdown-menu-hidden">
                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-filter-type="tag" data-filter-value="All" onclick="selectFilter(this)">All Tags</a>
                        <!-- Tag links generated by JS -->
                    </div>
                </div>
                
                <!-- Dropdown: Clubs (Click-to-Toggle) -->
                <div class="relative inline-block text-left" id="club-group">
                    <button id="club-toggle" onclick="toggleDropdown(this)" class="dropdown-toggle text-gray-600 hover:bg-blue-50 hover:text-blue-600 px-3 py-2 rounded-lg transition duration-150 ease-in-out focus:outline-none">Clubs</button>
                    <div id="clubDropdown" class="absolute left-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-xl transition duration-200 z-20 origin-top dropdown-menu-hidden">
                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-filter-type="club" data-filter-value="All" onclick="selectFilter(this)">All Clubs</a>
                        <!-- Club links generated by JS -->
                    </div>
                </div>

                <!-- Static Links -->
                <a href="#seminars" class="text-gray-600 hover:bg-blue-50 hover:text-blue-600 px-3 py-2 rounded-lg transition duration-150 ease-in-out">Seminars</a>
                <a href="#guests" class="text-gray-600 hover:bg-blue-50 hover:text-blue-600 px-3 py-2 rounded-lg transition duration-150 ease-in-out">Guests</a>
                <a href="#about" class="text-gray-600 hover:bg-blue-50 hover:text-blue-600 px-3 py-2 rounded-lg transition duration-150 ease-in-out">About Us</a>
            </nav>

        </div>
    </header>

    <!-- MAIN CONTENT AREA -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-4">
        
        <!-- News Section - Magazine Style -->
        <div id="news-section" class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 border-b-2 border-gray-200 pb-2">Campus Magazine: Latest Buzz</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- News Item 1 -->
                <div class="bg-white p-4 rounded-xl shadow-lg hover:shadow-xl transition duration-300 border border-gray-100">
                    <h3 class="font-bold text-lg text-gray-700 mb-1">Students Win National Code Challenge</h3>
                    <p class="text-sm text-gray-500 mb-3">Oct 18, 2025</p>
                    <p class="text-gray-600 text-sm">A team of four from the CSE department secured 1st place in the 'Innovate India' hackathon. Read more...</p>
                </div>
                <!-- News Item 2 -->
                <div class="bg-white p-4 rounded-xl shadow-lg hover:shadow-xl transition duration-300 border border-gray-100">
                    <h3 class="font-bold text-lg text-gray-700 mb-1">New Robotics Lab Inaugurated</h3>
                    <p class="text-sm text-gray-500 mb-3">Oct 15, 2025</p>
                    <p class="text-gray-600 text-sm">The Mechanical and ECE departments celebrate the launch of a state-of-the-art facility.</p>
                </div>
                <!-- News Item 3 -->
                <div class="bg-white p-4 rounded-xl shadow-lg hover:shadow-xl transition duration-300 border border-gray-100">
                    <h3 class="font-bold text-lg text-gray-700 mb-1">Alumni Talk Series Announced</h3>
                    <p class="text-sm text-gray-500 mb-3">Oct 12, 2025</p>
                    <p class="text-gray-600 text-sm">Successful graduates share their career journey in a monthly virtual series.</p>
                </div>
            </div>
        </div>
        
        <h2 id="events-title" class="text-3xl font-bold text-gray-800 mb-6 border-b pb-2">Upcoming & Ongoing Events (Posterboard)</h2>

        <!-- POSTERBOARD VIEW -->
        <div id="posterboard-view" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 mb-12">
            <!-- Event Cards will be dynamically inserted here by JavaScript -->
        </div>

        <!-- TIMELINE VIEW (Hidden by default) -->
        <div id="timeline-view" class="hidden mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 border-b pb-2">Event Timeline & Calendar View</h2>
            <div id="timelineContainer" class="space-y-8 relative">
                <!-- Vertical Line for Timeline -->
                <div class="absolute left-4 top-0 bottom-0 w-1 bg-blue-200 md:left-1/2 md:-translate-x-1/2"></div>
                <!-- Timeline items will be dynamically inserted here by JavaScript -->
            </div>
        </div>
        
    </div>

    <!-- JAVASCRIPT: DATA, RENDERING, AND FILTERING LOGIC -->
    <script>
        // --- 1. CORE DATA STRUCTURES (Mock Database) ---

        // These lists simulate lookup tables for filters
        const departments = ["CSE", "ECE", "Mech", "Civil", "Biotech", "Management", "Science"];
        const tags = ["Technical", "Cultural", "Workshop", "Competition", "Seminar", "Social"];
        const clubs = ["IEEE", "TedX", "Photo Club", "NSS", "Rotaract", "Gaming Guild"];

        // New map for status-based border colors (as requested: Done=Gray, Ongoing=Green, Upcoming=Yellow)
        const statusOutlineColors = {
            'Upcoming': 'border-yellow-500', 
            'Ongoing': 'border-green-500',
            'Done': 'border-gray-500'
        };

        // Extensive Mock Event Data (12 events) - UPDATE THIS ARRAY TO MOCK DATABASE CHANGES
        const eventsData = [
            { id: 1, title: "Data Science Seminar: The Future of AI", date: "Oct 25, 2025", time: "10:00 AM", department: "CSE", tags: ["Technical", "Seminar"], club: "IEEE", status: "Upcoming", color: "blue" },
            { id: 2, title: "Photography Club - Weekly Meetup", date: "Oct 20, 2025", time: "4:30 PM", department: "Science", tags: ["Cultural", "Social"], club: "Photo Club", status: "Ongoing", color: "orange" },
            { id: 3, title: "CodeStorm Hackathon Registration Deadline", date: "Nov 1, 2025", time: "11:59 PM", department: "CSE", tags: ["Technical", "Competition"], club: "IEEE", status: "Upcoming", color: "pink" },
            { id: 4, title: "TEDx BMSCE: Limitless Potential", date: "Nov 15, 2025", time: "9:00 AM", department: "Management", tags: ["Seminar", "Social"], club: "TedX", status: "Upcoming", color: "red" },
            { id: 5, title: "SolidWorks Design Workshop", date: "Oct 28, 2025", time: "2:00 PM", department: "Mech", tags: ["Technical", "Workshop"], club: null, status: "Upcoming", color: "green" },
            { id: 6, title: "Debate & Rhetoric Competition", date: "Oct 22, 2025", time: "1:00 PM", department: "Civil", tags: ["Cultural", "Competition"], club: "Rotaract", status: "Ongoing", color: "purple" },
            { id: 7, title: "Biotech Symposium 2025", date: "Nov 5, 2025", time: "9:30 AM", department: "Biotech", tags: ["Technical", "Seminar"], club: null, status: "Upcoming", color: "teal" },
            { id: 8, title: "Drone Racing League Tryouts", date: "Oct 19, 2025", time: "3:00 PM", department: "ECE", tags: ["Technical", "Competition"], club: "Gaming Guild", status: "Done", color: "gray" },
            { id: 9, title: "NSS Cleanup Drive: Campus Beautification", date: "Oct 24, 2025", time: "8:00 AM", department: "All", tags: ["Social"], club: "NSS", status: "Ongoing", color: "lime" },
            { id: 10, title: "Finance & Investment Talk", date: "Nov 10, 2025", time: "4:00 PM", department: "Management", tags: ["Seminar", "Workshop"], club: null, status: "Upcoming", color: "indigo" },
            { id: 11, title: "Intro to Python Workshop for ECE", date: "Nov 8, 2025", time: "10:00 AM", department: "ECE", tags: ["Technical", "Workshop"], club: "IEEE", status: "Done", color: "yellow" },
            { id: 12, title: "Annual College Fest Planning Meeting", date: "Oct 21, 2025", time: "6:00 PM", department: "All", tags: ["Cultural", "Social"], club: "Rotaract", status: "Ongoing", color: "fuchsia" }
        ];

        // Map status to Tailwind colors for tag backgrounds (kept the old mapping)
        const statusColors = {
            'Upcoming': { bg: 'bg-yellow-100', text: 'text-yellow-800' }, // Changed to yellow for consistency
            'Ongoing': { bg: 'bg-green-100', text: 'text-green-800' },
            'Done': { bg: 'bg-gray-100', text: 'text-gray-600' }
        };

        // Current filter state
        let currentFilters = {
            search: '',
            department: 'All',
            tag: 'All',
            club: 'All'
        };


        // --- 2. DYNAMIC RENDERING FUNCTIONS ---

        /**
         * Generates the Posterboard HTML for a single event.
         */
        function createPosterCard(event) {
            const statusColor = statusColors[event.status];
            // Use statusOutlineColors for the main border as requested
            const outlineClass = statusOutlineColors[event.status] || 'border-gray-300';
            
            const tagsHtml = event.tags.map(tag => `
                <span class="tag bg-${event.color}-100 text-${event.color}-800 px-3 py-1 rounded-full text-xs font-medium">${tag}</span>
            `).join('');

            // Note: The border color is dynamically applied using ${outlineClass}
            return `
                <div class="event-card bg-white rounded-xl shadow-xl overflow-hidden transform hover:scale-[1.02] transition duration-300 cursor-pointer" 
                     data-search-terms="${event.title.toLowerCase()} ${event.date.toLowerCase()} ${event.tags.join(' ').toLowerCase()} ${event.department.toLowerCase()} ${event.club ? event.club.toLowerCase() : ''}"
                     data-department="${event.department}"
                     data-tag="${event.tags.join('|')}"
                     data-club="${event.club || 'None'}"
                >
                    <!-- Poster Placeholder -->
                    <div class="h-48 w-full bg-gray-200 flex items-center justify-center text-gray-500 font-bold border-b-4 ${outlineClass}" 
                         style="background-image: url('https://placehold.co/600x400/${event.color}/ffffff?text=POSTER'); background-size: cover; background-position: center;">
                    </div>

                    <div class="p-4">
                        <h3 class="event-title text-xl font-bold text-gray-800 mb-2 leading-snug">${event.title}</h3>
                        
                        <p class="text-sm text-gray-500 mb-3">
                            <span class="font-semibold text-gray-600">Date:</span> ${event.date} | 
                            <span class="font-semibold text-gray-600">Time:</span> ${event.time}
                        </p>

                        <!-- Tag Bubbles -->
                        <div class="mt-3 flex flex-wrap gap-2">
                            ${tagsHtml}
                            <span class="px-3 py-1 text-xs font-semibold rounded-full ${statusColor.bg} ${statusColor.text}">${event.status}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        /**
         * Generates the Timeline HTML for a single event.
         */
        function createTimelineItem(event, isLeft) {
            const statusColor = statusColors[event.status];
            const outlineClass = statusOutlineColors[event.status] || 'border-gray-300'; // Apply border colors here too
            
            const tagsHtml = event.tags.map(tag => `<span class="tag bg-${event.color}-100 text-${event.color}-800 px-2 py-0.5 rounded-full text-xs font-medium">${tag}</span>`).join('');
            
            // Positioning logic for responsive timeline
            const alignment = isLeft ? 'md:left-0 md:text-right' : 'md:left-1/2 md:text-left';
            const contentPosition = isLeft ? 'md:pr-12' : 'md:pl-12';
            const dotPosition = isLeft ? 'md:left-1/2 md:translate-x-[calc(50%-2px)]' : 'md:left-1/2 md:-translate-x-[50%]' ;

            return `
                <div class="relative mb-8 flex ${alignment}">
                    <!-- Timeline Dot -->
                    <div class="absolute left-4 top-0 h-full flex items-center justify-center ${dotPosition}">
                        <div class="w-8 h-8 rounded-full bg-white border-4 ${outlineClass} shadow-lg"></div>
                    </div>
                    
                    <!-- Content Card -->
                    <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 ${outlineClass} w-full md:w-1/2 ${contentPosition} ml-12 md:ml-0">
                        <div class="text-sm text-gray-500 mb-1 font-mono">${event.date} at ${event.time}</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2 leading-snug">${event.title}</h3>
                        <p class="text-gray-600 text-sm mb-3">
                            <span class="font-semibold">Dept:</span> ${event.department} | 
                            <span class="font-semibold">Club:</span> ${event.club || 'N/A'}
                        </p>
                        <div class="flex flex-wrap gap-2 mt-2">
                            ${tagsHtml}
                            <span class="px-2 py-0.5 text-xs font-semibold rounded-full ${statusColor.bg} ${statusColor.text}">${event.status}</span>
                        </div>
                    </div>
                </div>
            `;
        }
        
        /**
         * Renders events into the specified container using the given renderer function.
         */
        function renderEvents(containerId, data, renderer, sorted = false) {
            const container = document.getElementById(containerId);
            if (!container) return;

            // Apply filters to the data
            const filteredData = data.filter(event => {
                const searchMatch = (
                    event.title.toLowerCase().includes(currentFilters.search) ||
                    event.date.toLowerCase().includes(currentFilters.search) ||
                    (event.club && event.club.toLowerCase().includes(currentFilters.search)) ||
                    event.tags.map(t => t.toLowerCase()).join(' ').includes(currentFilters.search)
                );
                
                const deptMatch = currentFilters.department === 'All' || event.department === currentFilters.department;
                const tagMatch = currentFilters.tag === 'All' || event.tags.includes(currentFilters.tag);
                const clubMatch = currentFilters.club === 'All' || event.club === currentFilters.club;

                return searchMatch && deptMatch && tagMatch && clubMatch;
            });

            if (sorted) {
                // Sort by date for the timeline
                filteredData.sort((a, b) => new Date(a.date) - new Date(b.date));
            }

            container.innerHTML = filteredData.map((event, index) => {
                // For Timeline view, alternate left and right placement
                if (containerId === 'timelineContainer') {
                    return renderer(event, index % 2 === 0);
                }
                return renderer(event);
            }).join('');
            
            if (filteredData.length === 0) {
                container.innerHTML = `<p class="text-xl text-center col-span-full py-10 text-gray-500">No events match your current filters.</p>`;
            }
        }

        /**
         * Switches the main content view between Posterboard and Timeline.
         */
        function switchView(view) {
            const posterView = document.getElementById('posterboard-view');
            const timelineView = document.getElementById('timeline-view');
            const newsSection = document.getElementById('news-section');
            const eventsTitle = document.getElementById('events-title');

            if (view === 'posterboard') {
                posterView.classList.remove('hidden');
                timelineView.classList.add('hidden');
                newsSection.classList.remove('hidden');
                eventsTitle.textContent = "Upcoming & Ongoing Events (Posterboard)";
                renderEvents('posterboard-view', eventsData, createPosterCard);
            } else if (view === 'timeline') {
                timelineView.classList.remove('hidden');
                posterView.classList.add('hidden');
                newsSection.classList.add('hidden');
                eventsTitle.textContent = "All Events in Chronological Order";
                renderEvents('timelineContainer', eventsData, createTimelineItem, true);
            }
        }
        
        // --- 3. FILTERING & DROPDOWN LOGIC ---
        
        /**
         * Closes all dropdowns except the one that triggered the click (if any).
         */
        function closeAllDropdowns(event = null) {
            const dropdowns = document.querySelectorAll('.dropdown-menu-visible');
            dropdowns.forEach(menu => {
                // If an event object is provided, check if the click was inside this menu or its button
                if (event) {
                    const button = menu.previousElementSibling;
                    const container = menu.parentElement;
                    if (container.contains(event.target)) {
                        return; // Clicked inside the active dropdown or its button, so don't close it
                    }
                }
                menu.classList.remove('dropdown-menu-visible');
                menu.classList.add('dropdown-menu-hidden');
            });
        }
        
        /**
         * Toggles the visibility of the clicked dropdown menu.
         */
        function toggleDropdown(button) {
            // Stop the click from immediately propagating to the body's closeAllDropdowns handler
            event.stopPropagation();
            
            const menu = button.nextElementSibling;
            
            // Close all OTHER dropdowns first
            closeAllDropdowns(); 
            
            // Then toggle the clicked menu
            menu.classList.toggle('dropdown-menu-hidden');
            menu.classList.toggle('dropdown-menu-visible');
        }


        /**
         * Updates the filter state and re-renders the events in the current view.
         */
        function applyFilters() {
            const searchInput = document.getElementById('eventSearch');
            currentFilters.search = searchInput.value.toLowerCase().trim();
            
            // Determine which view is active and render accordingly
            if (!document.getElementById('posterboard-view').classList.contains('hidden')) {
                renderEvents('posterboard-view', eventsData, createPosterCard);
            } else if (!document.getElementById('timeline-view').classList.contains('hidden')) {
                renderEvents('timelineContainer', eventsData, createTimelineItem, true);
            }
        }

        /**
         * Handles filter selection from dropdowns.
         */
        function selectFilter(element) {
            const filterType = element.getAttribute('data-filter-type');
            const filterValue = element.getAttribute('data-filter-value');
            
            currentFilters[filterType] = filterValue;
            
            // Update the dropdown button text to show the active filter
            const button = element.closest('.relative').querySelector('.dropdown-toggle');
            if (button) {
                 const baseText = button.textContent.split(':')[0];
                 button.textContent = filterValue === 'All' ? baseText : `${baseText}: ${filterValue}`;
            }

            applyFilters();
            // Close the dropdown after selection
            closeAllDropdowns();
            return false; // Prevent default link behavior
        }


        // --- 4. INITIALIZATION ---

        /**
         * Initializes the dropdown menus with data from the static lists.
         */
        function initializeDropdowns() {
            function populateDropdown(dataArray, dropdownId, filterType) {
                const dropdown = document.getElementById(dropdownId);
                if (!dropdown) return;

                const allOption = dropdown.querySelector('[data-filter-value="All"]');
                let html = allOption.outerHTML;

                dataArray.forEach(item => {
                    html += `
                        <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" 
                           data-filter-type="${filterType}" data-filter-value="${item}" onclick="selectFilter(this)">${item}</a>
                    `;
                });
                dropdown.innerHTML = html;
            }

            populateDropdown(departments, 'departmentDropdown', 'department');
            populateDropdown(tags, 'tagDropdown', 'tag');
            populateDropdown(clubs, 'clubDropdown', 'club');
        }

        // Run initialization functions on load
        window.onload = function() {
            initializeDropdowns();
            // Default to Posterboard View on load
            renderEvents('posterboard-view', eventsData, createPosterCard);
            console.log("BMSCE Event Hub initialized with dynamic content, filters, and Timeline view.");
        }
    </script>

</body>
</html>